(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{19:function(e,t,r){e.exports=r(45)},24:function(e,t,r){},26:function(e,t,r){},45:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),a=r(18),s=r.n(a),o=(r(24),r(6)),c=r.n(o),l=r(8),u=r(2),h=r(3),d=r(7),g=r(5),v=r(4),p=function(e){Object(g.a)(r,e);var t=Object(v.a)(r);function r(){return Object(u.a)(this,r),t.apply(this,arguments)}return Object(h.a)(r,[{key:"render",value:function(){return i.a.createElement("nav",{id:"nav-game-menu"},i.a.createElement("div",null,i.a.createElement("button",{id:"new",className:"btn",onClick:this.props.newGame},"New Game"),i.a.createElement("button",{id:"start",className:"btn",onClick:this.props.startGame},"Start"),i.a.createElement("button",{id:"undo",className:"btn",onClick:this.props.undo},"Undo")))}}]),r}(n.Component),m=function(e){Object(g.a)(r,e);var t=Object(v.a)(r);function r(){return Object(u.a)(this,r),t.apply(this,arguments)}return Object(h.a)(r,[{key:"render",value:function(){return i.a.createElement("div",{className:"info"},i.a.createElement("div",{id:"player"},"\u2654"),i.a.createElement("div",{id:"timer"},"00:00"))}}]),r}(n.Component),f=function(e){Object(g.a)(r,e);var t=Object(v.a)(r);function r(){return Object(u.a)(this,r),t.apply(this,arguments)}return Object(h.a)(r,[{key:"renderPiece",value:function(e){var t=new DOMParser;return""!==e?t.parseFromString("<!doctype html><body>".concat(P[e]),"text/html").body.textContent:e}},{key:"render",value:function(){var e=this.props.field,t=e.file,r=e.rank,n=e.color,a=e.piece,s=t+r;return i.a.createElement("td",{key:s,id:s,className:n,onClick:this.props.handleClick.bind(this,t,r)},this.renderPiece(a))}}]),r}(n.Component),P={"K-W":"&#x2654;","Q-W":"&#x2655;","R-W":"&#x2656;","B-W":"&#x2657;","N-W":"&#x2658;","P-W":"&#x2659;","K-B":"&#x265A;","Q-B":"&#x265B;","R-B":"&#x265C;","B-B":"&#x265D;","N-B":"&#x265E;","P-B":"&#x265F;"},k=f,b=function(e){Object(g.a)(r,e);var t=Object(v.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).handleClick=function(){var e=Object(l.a)(c.a.mark((function e(t,r){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t+r,!n.props.running){e.next=40;break}if(null!==n.state.selected.id){e.next=9;break}if(""===n.getPiece(t,r)){e.next=7;break}if(n.props.player!==n.getPieceColor(t,r)){e.next=7;break}return e.next=7,n.selectPiece(t,r);case 7:e.next=40;break;case 9:if(n.state.selected.id!==i){e.next=14;break}return e.next=12,n.unselectPiece();case 12:e.next=40;break;case 14:if(!n.state.selected.validMoves.includes(i)){e.next=31;break}return n.handleMove(n.state.selected.id,i),e.next=18,n.unselectPiece();case 18:if(!0!==n.validateCheck()){e.next=25;break}return console.log("Under check, move denied"),n.props.undo(),e.next=23,n.props.switchPlayer();case 23:e.next=29;break;case 25:return e.next=27,n.props.switchPlayer();case 27:n.props.resetTimer(),!0===n.validateCheck()&&(n.validateCheckmate()?(alert("Checkmate! "+("W"===n.props.player?"Blacks win!":"Whites Win!")),n.props.gameOver()):(console.log("Check declaration"),alert("Check")));case 29:e.next=40;break;case 31:if(n.getPieceColor(t,r)!==n.props.player){e.next=38;break}return e.next=34,n.unselectPiece();case 34:return e.next=36,n.selectPiece(t,r);case 36:e.next=40;break;case 38:return e.next=40,n.unselectPiece();case 40:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),n.getValidMoves=function(e,t){var r=null,i={file:e,rank:t};switch(n.getPiece(e,t)){case"P-W":r=n.getPawnMoves(i,"W");break;case"P-B":r=n.getPawnMoves(i,"B");break;case"K-W":r=n.getKingMoves(i,"W");break;case"K-B":r=n.getKingMoves(i,"B");break;case"N-W":r=n.getKnightMoves(i,"W");break;case"N-B":r=n.getKnightMoves(i,"B");break;case"R-W":r=n.getRookMoves(i,"W");break;case"R-B":r=n.getRookMoves(i,"B");break;case"B-W":r=n.getBishopMoves(i,"W");break;case"B-B":r=n.getBishopMoves(i,"B");break;case"Q-W":r=n.getQueenMoves(i,"W");break;case"Q-B":r=n.getQueenMoves(i,"B");break;default:r=[]}return r},n.renderBoard=function(){var e=n.props,t=e.error,r=e.isLoaded;if(t)return i.a.createElement("div",{className:"error"},"Error: ",t.message);if(r){for(var a=[],s=7;s>=0;s--){for(var o=[],c=0;c<=7;c++){var l={file:y[c],rank:B[s],color:c%2===s%2?"black-field":"white-field",piece:n.getPiece(y[c],B[s])};o.push(i.a.createElement(k,{key:l.file+l.rank,field:l,handleClick:n.handleClick}))}a.push(i.a.createElement("tr",{key:s,id:s},o))}return i.a.createElement("div",{className:"chess-container"},i.a.createElement("table",{id:"chess-board",className:"chess-board"},i.a.createElement("tbody",null,a)))}return i.a.createElement("div",{className:"loading"},"Loading...")},n.state={selected:{id:null,position:{file:null,rank:null},piece:null,color:null,validMoves:[]}},n}return Object(h.a)(r,[{key:"selectPiece",value:function(){var e=Object(l.a)(c.a.mark((function e(t,r){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t+r,e.next=3,this.setState({selected:{id:n,position:{file:t,rank:r},piece:this.getPiece(t,r),validMoves:this.getValidMoves(t,r),color:this.getPieceColor(t,r)}});case 3:document.getElementById(n).classList.add("selected"),this.highlightValidMoves(this.state.selected.validMoves);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"unselectPiece",value:function(){var e=Object(l.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,document.getElementById(this.state.selected.id).classList.remove("selected"),this.unhighlightValidMoves(this.state.selected.validMoves),e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:return e.prev=8,e.next=11,this.setState({selected:{id:null,position:{file:null,rank:null},piece:null,validMoves:null,color:null}});case 11:return e.finish(8);case 12:case"end":return e.stop()}}),e,this,[[0,5,8,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleMove",value:function(e,t){if(""!==document.getElementById(e).innerHTML){var r=e.split(""),n={file:r[0],rank:r[1]},i=this.getPiece(n.file,n.rank);this.setPiece(n.file,n.rank,""),n={file:(r=t.split(""))[0],rank:r[1]},this.setPiece(n.file,n.rank,i);var a=document.getElementById(e);document.getElementById(t).innerHTML=a.innerHTML,a.innerHTML="",this.saveMove([e,t])}}},{key:"getPawnMoves",value:function(e,t){var r=e.file.charCodeAt(0),n=null;n="B"===t?[[0,-1],[0,-2],[-1,-1],[1,-1]]:[[0,1],[0,2],[-1,1],[1,1]];for(var i="",a=[],s=0;s<n.length;s++){var o=String.fromCharCode(r+n[s][0]),c=String(parseInt(e.rank)+n[s][1]);y.includes(o)&&B.includes(c)&&((0!==n[s][0]||-2!==n[s][1]&&2!==n[s][1]||"7"!==e.rank&&"2"!==e.rank||""!==this.getPiece(o,c))&&(0!==n[s][0]||-1!==n[s][1]&&1!==n[s][1]||""!==this.getPiece(o,c))?0!==n[s][0]&&""!==this.getPiece(o,c)&&this.getPieceColor(o,c)!==t&&(i=o+c,a.push(i)):(i=o+c,a.push(i)))}return a}},{key:"getKingMoves",value:function(e,t){for(var r=e.file.charCodeAt(0),n=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[-2,0],[2,0]],i="",a=[],s=0;s<n.length;s++){var o=String.fromCharCode(r+n[s][0]),c=String(parseInt(e.rank)+n[s][1]);y.includes(o)&&B.includes(c)&&(2===Math.abs(n[s][0])||""!==this.getPiece(o,c)&&this.getPieceColor(o,c)===t||(i=o+c,a.push(i)))}return a}},{key:"getKnightMoves",value:function(e,t){for(var r=e.file.charCodeAt(0),n=[[1,2],[2,1],[2,-1],[1,-2],[-1,-2],[-2,-1],[-2,1],[-1,2]],i="",a=[],s=0;s<n.length;s++){var o=String.fromCharCode(r+n[s][0]),c=String(parseInt(e.rank)+n[s][1]);y.includes(o)&&B.includes(c)&&(""!==this.getPiece(o,c)&&this.getPieceColor(o,c)===t||(i=o+c,a.push(i)))}return a}},{key:"getRookMoves",value:function(e,t){for(var r=e.file.charCodeAt(0),n=[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[-1,0],[-2,0],[-3,0],[-4,0],[-5,0],[-6,0],[-7,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,-1],[0,-2],[0,-3],[0,-4],[0,-5],[0,-6],[0,-7]],i=!1,a=!1,s=!1,o=!1,c="",l=[],u=0;u<n.length;u++){var h=String.fromCharCode(r+n[u][0]),d=String(parseInt(e.rank)+n[u][1]);y.includes(h)&&B.includes(d)&&(""===this.getPiece(h,d)?(c=h+d,l.push(c)):n[u][0]>0&&""!==this.getPiece(h,d)&&!o?(u+=7-n[u][0],o=!0,this.getPieceColor(h,d)!==t&&(c=h+d,l.push(c))):n[u][0]<0&&""!==this.getPiece(h,d)&&!s?(u+=7+n[u][0],s=!0,this.getPieceColor(h,d)!==t&&(c=h+d,l.push(c))):n[u][1]>0&&""!==this.getPiece(h,d)&&!i?(u+=7-n[u][1],i=!0,this.getPieceColor(h,d)!==t&&(c=h+d,l.push(c))):n[u][1]<0&&""!==this.getPiece(h,d)&&!a&&(u+=7+n[u][1],a=!0,this.getPieceColor(h,d)!==t&&(c=h+d,l.push(c))))}return l}},{key:"getQueenMoves",value:function(e,t){for(var r=e.file.charCodeAt(0),n=[[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[-1,-1],[-2,-2],[-3,-3],[-4,-4],[-5,-5],[-6,-6],[-7,-7],[-1,1],[-2,2],[-3,3],[-4,4],[-5,5],[-6,6],[-7,7],[1,-1],[2,-2],[3,-3],[4,-4],[5,-5],[6,-6],[7,-7],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[-1,0],[-2,0],[-3,0],[-4,0],[-5,0],[-6,0],[-7,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,-1],[0,-2],[0,-3],[0,-4],[0,-5],[0,-6],[0,-7]],i=!1,a=!1,s=!1,o=!1,c=!1,l=!1,u=!1,h=!1,d="",g=[],v=0;v<n.length;v++){var p=String.fromCharCode(r+n[v][0]),m=String(parseInt(e.rank)+n[v][1]);y.includes(p)&&B.includes(m)&&(""===this.getPiece(p,m)?(d=p+m,g.push(d)):n[v][0]>0&&0===n[v][1]&&""!==this.getPiece(p,m)&&!h?(v+=7-n[v][0],h=!0,this.getPieceColor(p,m)!==t&&(d=p+m,g.push(d))):n[v][0]<0&&0===n[v][1]&&""!==this.getPiece(p,m)&&!u?(v+=7+n[v][0],u=!0,this.getPieceColor(p,m)!==t&&(d=p+m,g.push(d))):0===n[v][0]&&n[v][1]>0&&""!==this.getPiece(p,m)&&!c?(v+=7-n[v][1],c=!0,this.getPieceColor(p,m)!==t&&(d=p+m,g.push(d))):0===n[v][0]&&n[v][1]<0&&""!==this.getPiece(p,m)&&!l?(v+=7+n[v][1],l=!0,this.getPieceColor(p,m)!==t&&(d=p+m,g.push(d))):n[v][0]>0&&n[v][1]>0&&""!==this.getPiece(p,m)&&!i?(v+=7-n[v][0],i=!0,this.getPieceColor(p,m)!==t&&(d=p+m,g.push(d))):n[v][0]<0&&n[v][1]<0&&""!==this.getPiece(p,m)&&!a?(v+=7+n[v][0],a=!0,this.getPieceColor(p,m)!==t&&(d=p+m,g.push(d))):n[v][0]<0&&n[v][1]>0&&""!==this.getPiece(p,m)&&!s?(v+=7-n[v][1],s=!0,this.getPieceColor(p,m)!==t&&(d=p+m,g.push(d))):n[v][0]>0&&n[v][1]<0&&""!==this.getPiece(p,m)&&!o&&(v+=7+n[v][1],o=!0,this.getPieceColor(p,m)!==t&&(d=p+m,g.push(d))))}return g}},{key:"getBishopMoves",value:function(e,t){for(var r=e.file.charCodeAt(0),n=[[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[-1,-1],[-2,-2],[-3,-3],[-4,-4],[-5,-5],[-6,-6],[-7,-7],[-1,1],[-2,2],[-3,3],[-4,4],[-5,5],[-6,6],[-7,7],[1,-1],[2,-2],[3,-3],[4,-4],[5,-5],[6,-6],[7,-7]],i=!1,a=!1,s=!1,o=!1,c="",l=[],u=0;u<n.length;u++){var h=String.fromCharCode(r+n[u][0]),d=String(parseInt(e.rank)+n[u][1]);y.includes(h)&&B.includes(d)&&(""===this.getPiece(h,d)?(c=h+d,l.push(c)):n[u][0]>0&&n[u][1]>0&&""!==this.getPiece(h,d)&&!i?(u+=7-n[u][0],i=!0,this.getPieceColor(h,d)!==t&&(c=h+d,l.push(c))):n[u][0]<0&&n[u][1]<0&&""!==this.getPiece(h,d)&&!a?(u+=7+n[u][0],a=!0,this.getPieceColor(h,d)!==t&&(c=h+d,l.push(c))):n[u][0]<0&&n[u][1]>0&&""!==this.getPiece(h,d)&&!s?(u+=7-n[u][1],s=!0,this.getPieceColor(h,d)!==t&&(c=h+d,l.push(c))):n[u][0]>0&&n[u][1]<0&&""!==this.getPiece(h,d)&&!o&&(u+=7+n[u][1],o=!0,this.getPieceColor(h,d)!==t&&(c=h+d,l.push(c))))}return l}},{key:"highlightValidMoves",value:function(e){e.forEach((function(e){document.getElementById(e).classList.add("highlighted")}))}},{key:"unhighlightValidMoves",value:function(e){e.forEach((function(e){document.getElementById(e).classList.remove("highlighted")}))}},{key:"heighlightPreviousMove",value:function(e,t){document.getElementById(e).classList.add("highlighted-move"),document.getElementById(t).classList.add("highlighted-move")}},{key:"unheighlightPreviousMove",value:function(){var e=this.props.record.moves.length;if(e>0){var t=this.props.record.moves[e-1][0],r=this.props.record.moves[e-1][1];document.getElementById(t).classList.remove("highlighted-move"),document.getElementById(r).classList.remove("highlighted-move")}}},{key:"saveMove",value:function(e){var t=JSON.parse(JSON.stringify(this.props.board));this.props.record.boards.push(t),this.props.record.moves.push(e)}},{key:"getPieceColor",value:function(e,t){return this.getPiece(e,t).charAt(2)}},{key:"getPiece",value:function(e,t){return this.props.board[e][t]}},{key:"setPiece",value:function(e,t,r){this.props.board[e][t]=r}},{key:"getPiecePosition",value:function(e){for(var t=7;t>=0;t--)for(var r=0;r<8;r++)if(this.getPiece(y[r],B[t])===e)return y[r]+B[t]}},{key:"validateCheck",value:function(){var e=this,t=!1,r="B"===this.props.player?this.getPiecePosition("K-B"):this.getPiecePosition("K-W");return("B"===this.props.player?M:C).forEach((function(n){var i=e.getPiecePosition(n);if(null!==i&&e.getValidMoves(i.charAt(0),i.charAt(1)).includes(r))return t=!0})),t}},{key:"validateCheckmate",value:function(){var e=this,t=(JSON.parse(JSON.stringify(this.props.board)),[]),r=!0,n="B"===this.props.player?M:C,i="B"===this.props.player?C:M,a="B"===this.props.player?this.getPiecePosition("K-B"):this.getPiecePosition("K-W");return this.getValidMoves(a.charAt(0),a.charAt(1)).forEach((function(i){if(n.forEach((function(r){var n=e.getPiecePosition(r);null!==n&&e.getValidMoves(n.charAt(0),n.charAt(1)).includes(i)&&t.push(i)})),!t.includes(i))return r=!1,!1})),i.forEach((function(t){var r=e.getPiecePosition(t);null!==r&&e.getValidMoves(r.charAt(0),r.charAt(1)).forEach((function(e){}))})),r}},{key:"render",value:function(){return this.renderBoard()}}]),r}(n.Component),y=["a","b","c","d","e","f","g","h"],B=["1","2","3","4","5","6","7","8"],C=["P-B","N-B","B-B","R-B","Q-B","K-B"],M=["P-W","N-W","B-W","R-W","Q-W","K-W"],E=b,S=(r(26),r(27),function(e){Object(g.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(u.a)(this,r),(e=t.call(this)).switchStatus=function(){e.setState({running:!e.state.running})},e.loadBoard=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({board:JSON.parse(JSON.stringify(w)),isLoaded:!0});case 2:e.state.isLoaded&&e.setState({record:{boards:[JSON.parse(JSON.stringify(e.state.board))],moves:[]}});case 3:case"end":return t.stop()}}),t)}))),e.newGame=function(){console.log("New game is set"),e.initialize(),e.stopTimer(),e.resetTimer()},e.startGame=function(){"Start"===document.getElementById("start").innerHTML?(e.startTimer(),e.switchStatus(),document.getElementById("start").innerHTML="Pause"):(e.stopTimer(),document.getElementById("start").innerHTML="Start",e.switchStatus())},e.undo=function(){if(e.state.record.boards.length>1){e.state.record.boards.pop(),e.state.record.moves.pop();var t=e.state.record.boards,r=e.state.record.moves,n=JSON.parse(JSON.stringify(e.state.record.boards[e.state.record.boards.length-1]));e.setState({board:n,record:{boards:t,moves:r}}),e.switchPlayer()}},e.startTimer=function(){var t=setInterval(e.clock,1e3);e.setState({timer:t})},e.clock=function(){var t=e.state.time+1;e.setState({time:t}),document.getElementById("timer").innerHTML=(e.getMinutes()<=9?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<=9?"0"+e.getSeconds():e.getSeconds())},e.state={error:null,isLoaded:!1,board:null,player:null,running:null,time:null,timer:null,winner:null,record:{boards:null,moves:null}},e.switchPlayer=e.switchPlayer.bind(Object(d.a)(e)),e.resetTimer=e.resetTimer.bind(Object(d.a)(e)),e.undo=e.undo.bind(Object(d.a)(e)),e.gameOver=e.gameOver.bind(Object(d.a)(e)),e}return Object(h.a)(r,[{key:"componentDidMount",value:function(){this.initialize()}},{key:"switchPlayer",value:function(){this.state.player===W.whites?(this.setState({player:W.blacks}),document.getElementById("player").innerHTML="&#x265A;"):(this.setState({player:W.whites}),document.getElementById("player").innerHTML="&#x2654;")}},{key:"initialize",value:function(){this.loadBoard(),this.setState({player:W.whites,running:!1,timer:0,time:0,record:{boards:[],moves:[]}})}},{key:"gameOver",value:function(){this.switchStatus(),this.stopTimer(),document.getElementById("start").innerHTML="Start"}},{key:"getMinutes",value:function(){return Math.floor(this.state.time/60)}},{key:"getSeconds",value:function(){return this.state.time-60*this.getMinutes()}},{key:"stopTimer",value:function(){clearInterval(this.state.timer)}},{key:"resetTimer",value:function(){this.setState({time:0}),document.getElementById("timer").innerHTML="00:00"}},{key:"render",value:function(){var e=this.state,t=e.running,r=e.player,n=e.record,a=e.board,s=e.error,o=e.isLoaded;return i.a.createElement("main",{className:"App"},i.a.createElement("header",{className:"App-header container-fluid"},i.a.createElement(p,{startGame:this.startGame,newGame:this.newGame,undo:this.undo}),i.a.createElement(m,null),i.a.createElement(E,{board:a,error:s,isLoaded:o,running:t,player:r,record:n,switchPlayer:this.switchPlayer,resetTimer:this.resetTimer,undo:this.undo,gameOver:this.gameOver})))}}]),r}(n.Component)),W={whites:"W",blacks:"B"},w={a:{1:"R-W",2:"P-W",3:"",4:"",5:"",6:"",7:"P-B",8:"R-B"},b:{1:"N-W",2:"P-W",3:"",4:"",5:"",6:"",7:"P-B",8:"N-B"},c:{1:"B-W",2:"P-W",3:"",4:"",5:"",6:"",7:"P-B",8:"B-B"},d:{1:"Q-W",2:"P-W",3:"",4:"",5:"",6:"",7:"P-B",8:"Q-B"},e:{1:"K-W",2:"P-W",3:"",4:"",5:"",6:"",7:"P-B",8:"K-B"},f:{1:"B-W",2:"P-W",3:"",4:"",5:"",6:"",7:"P-B",8:"B-B"},g:{1:"N-W",2:"P-W",3:"",4:"",5:"",6:"",7:"P-B",8:"N-B"},h:{1:"R-W",2:"P-W",3:"",4:"",5:"",6:"",7:"P-B",8:"R-B"}},x=S;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.127ab0af.chunk.js.map